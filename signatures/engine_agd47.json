{
    "id": "agd-4.7",
    "name": "AGD 4.7 (Arcade Game Designer)",
    "type": "engine",
    "source": "Jonathan Cauldwell — AGD v0.7.10 runtime (EngineZX.asm). Import signatures/agd_engine.asm and build anchors from a loaded AGD game.",
    "baseAddress": 24832,
    "machineType": "48k",
    "anchors": [],
    "labels": {
        "6100": "start",
        "6109": "joyval",
        "610a": "frmno",
        "610b": "wintop",
        "610c": "winlft",
        "610d": "winhgt",
        "610e": "winwid",
        "610f": "numob",
        "6110": "wntopx",
        "6111": "wnlftx",
        "6112": "wnbotx",
        "6113": "wnrgtx",
        "6114": "scno",
        "6115": "numlif",
        "6116": "vara",
        "6117": "varb",
        "6118": "varc",
        "6119": "vard",
        "611a": "vare",
        "611b": "varf",
        "611c": "varg",
        "611d": "varh",
        "611e": "vari",
        "611f": "varj",
        "6120": "vark",
        "6121": "varl",
        "6122": "varm",
        "6123": "varn",
        "6124": "varo",
        "6125": "varp",
        "6126": "varq",
        "6127": "varr",
        "6128": "vars",
        "6129": "vart",
        "612a": "varu",
        "612b": "varv",
        "612c": "varw",
        "612d": "varz",
        "612e": "contrl",
        "612f": "charx",
        "6130": "chary",
        "6131": "clock",
        "6132": "varrnd",
        "6133": "varobj",
        "6134": "varopt",
        "6135": "varblk",
        "6136": "nexlev",
        "6137": "restfl",
        "6138": "deadf",
        "6139": "gamwon",
        "613a": "dispx",
        "613b": "dispy",
        "613c": "frmptr",
        "613e": "blkptr",
        "6140": "colptr",
        "6142": "proptr",
        "6144": "scrptr",
        "6146": "nmeptr",
        "6148": "minve",
        "6159": "mmenu",
        "6168": "dbox",
        "62ab": "dbar",
        "62c8": "invdis",
        "62d5": "fopt",
        "62f4": "fobj",
        "6300": "bwid",
        "6301": "blen",
        "6302": "btop",
        "6303": "blft",
        "6304": "prskey",
        "6310": "debkey",
        "631a": "delay",
        "6322": "xspr",
        "632d": "iniob",
        "634f": "vsync",
        "63b9": "sndtyp",
        "63ba": "redraw",
        "63ea": "cls",
        "6406": "setpal",
        "642b": "fdchk",
        "6451": "cspr",
        "64bb": "txtbit",
        "64bc": "txtwid",
        "64bd": "txtpos",
        "64bf": "txtini",
        "64c1": "txtscr",
        "64c3": "proshr",
        "64ef": "shrap",
        "653b": "dotl",
        "6541": "dotr",
        "6547": "dotu",
        "654d": "dotd",
        "6553": "chkxy",
        "6567": "plot",
        "6585": "kilshr",
        "658a": "shrsin",
        "65ca": "dots",
        "65d2": "trail",
        "65fb": "laser",
        "6613": "plotde",
        "6619": "shoot",
        "663b": "vapour",
        "6650": "ptusr",
        "666e": "star",
        "66b3": "fpslot",
        "66c6": "explod",
        "6700": "qrand",
        "670c": "seed3",
        "670d": "dshrp",
        "6724": "inishr",
        "6733": "lcol",
        "6768": "gamelp",
        "676d": "game",
        "6793": "rstrt",
        "679f": "rstrtn",
        "67c1": "mloop",
        "67fc": "newlev",
        "680b": "pdead",
        "681c": "tidyup",
        "683e": "rsevt",
        "6841": "num2ch",
        "6862": "num2dd",
        "6869": "num2td",
        "6872": "inisc",
        "687d": "imul",
        "6895": "idiv",
        "68a3": "shwob",
        "68c1": "dobj",
        "68d0": "dobjc",
        "68d6": "cobj",
        "691d": "remob",
        "6923": "getob",
        "693e": "gotob",
        "6948": "findob",
        "6955": "drpob",
        "6969": "skobj",
        "699c": "spawn",
        "69eb": "spptr",
        "69ed": "seed",
        "69ee": "score",
        "69f4": "hiscor",
        "69fa": "bonus",
        "6a00": "grbase",
        "6a02": "checkx",
        "6a08": "dscor",
        "6a39": "addsc",
        "6a4e": "addbo",
        "6a6b": "swpsb",
        "6a7d": "gprad",
        "6a94": "pradd",
        "6aa5": "gaadd",
        "6aba": "pchar",
        "6ad7": "colpat",
        "6ad8": "pattr",
        "6aeb": "panp",
        "6b07": "pchr",
        "6b1e": "sprite",
        "6b33": "groom",
        "6b46": "droom",
        "6b7d": "flbyt",
        "6b9d": "combyt",
        "6b9e": "comcnt",
        "6b9f": "laddd",
        "6ba9": "laddu",
        "6bc4": "cangu",
        "6bdd": "cangd",
        "6bf8": "cangl",
        "6c07": "cangr",
        "6c14": "cangh",
        "6c34": "lrchk",
        "6c3c": "always",
        "6c3e": "plchk",
        "6c4f": "ldchk",
        "6c52": "getcol",
        "6c75": "gtblk",
        "6c89": "tded",
        "6ce7": "tstbl",
        "6cee": "jump",
        "6d05": "hop",
        "6d10": "random",
        "6d32": "ktest",
        "6d4a": "joykey",
        "6d8e": "joyjoy",
        "6da1": "joysin",
        "6dc6": "dmsg",
        "6df0": "prtmod",
        "6df1": "bmsg1",
        "6e15": "bchar",
        "6e39": "achar",
        "6e47": "nexpos",
        "6e4c": "nexlin",
        "6e69": "preprt",
        "6e7c": "getwrd",
        "6e88": "bsort",
        "6ecb": "swspr",
        "6ee3": "pspr",
        "6f30": "ogptr",
        "6f32": "evtyp0",
        "6f34": "evtyp1",
        "6f36": "evtyp2",
        "6f38": "evtyp3",
        "6f3a": "evtyp4",
        "6f3c": "evtyp5",
        "6f3e": "evtyp6",
        "6f40": "evtyp7",
        "6f42": "evtyp8",
        "6f44": "dspr",
        "6fab": "gspran",
        "6fb3": "gsprad",
        "6fcf": "scadd",
        "6fe5": "spmask",
        "6fed": "sspria",
        "6ffd": "ssprib",
        "7002": "sspric",
        "700c": "nline",
        "701d": "animsp",
        "7026": "animbk",
        "703a": "sktyp",
        "705e": "skptr",
        "7060": "coltyp",
        "706a": "colc16",
        "7084": "disply",
        "709c": "displ0",
        "70a0": "initsc",
        "70a9": "tstsc",
        "70b4": "scrl",
        "70c7": "scrr",
        "70cd": "scru",
        "70d4": "scrd",
        "70d9": "nwscr",
        "70ee": "grav",
        "7130": "ogrv",
        "7171": "ifall",
        "7193": "tfall",
        "71a6": "gfrm",
        "71b6": "sprlst",
        "71c9": "nspr",
        "71d6": "ispr",
        "71f6": "kspr",
        "7216": "cpsp",
        "7260": "clw",
        "729d": "scrly",
        "730b": "iscrly",
        "733b": "rbloc",
        "733c": "plsnd",
        "733d": "sprtab",
        "7409": "ssprit",
        "741a": "roomtb"
    },
    "regions": [
        { "start": 24832, "end": 25415, "type": "code", "comment": "AGD variables and menu/inventory" },
        { "start": 25416, "end": 26191, "type": "code", "comment": "AGD vsync, redraw, screen, palette" },
        { "start": 26191, "end": 26563, "type": "code", "comment": "AGD sprite colouring and particles" },
        { "start": 26563, "end": 26984, "type": "code", "comment": "AGD particle engine (shrapnel, laser, vapour, starfield)" },
        { "start": 26984, "end": 27395, "type": "code", "comment": "AGD game loop, restart, death, scoring" },
        { "start": 27395, "end": 27758, "type": "code", "comment": "AGD objects, spawn, score display" },
        { "start": 27758, "end": 28060, "type": "code", "comment": "AGD printing, room drawing, decompression" },
        { "start": 28060, "end": 28494, "type": "code", "comment": "AGD movement checks, collision, physics" },
        { "start": 28494, "end": 28856, "type": "code", "comment": "AGD input, messages, text display" },
        { "start": 28856, "end": 29500, "type": "code", "comment": "AGD sprite processing, sorting, display" },
        { "start": 29500, "end": 29631, "type": "code", "comment": "AGD screen navigation, gravity, falling" },
        { "start": 29631, "end": 29757, "type": "code", "comment": "AGD sprite init, room sprites, clear window" },
        { "start": 29757, "end": 29501, "type": "code", "comment": "AGD scrolling ticker" },
        { "start": 29501, "end": 29961, "type": "db", "comment": "AGD sprite table (12x17 + spare)" }
    ],
    "comments": {
        "6100": "AGD engine entry point — set up font, start game",
        "6109": "Joystick reading storage",
        "610b": "Window dimensions (top, left, height, width)",
        "610f": "Number of objects in game",
        "6114": "Current screen number",
        "6115": "Number of lives remaining",
        "6116": "General-purpose variables A-Z (24 bytes, no X/Y)",
        "612e": "Control mode: 0=keyboard, 1=Kempston, 2=Sinclair, 3=Mouse",
        "6136": "Game state flags: nexlev, restfl, deadf, gamwon",
        "613a": "Display cursor position (dispx, dispy)",
        "613c": "Data pointers: frames, blocks, colours, properties, screens, enemies",
        "6148": "Display inventory menu",
        "6159": "Display standard menu",
        "6168": "Display message/menu box with selection",
        "62ab": "Draw/delete menu highlight bar",
        "6304": "Wait for keypress",
        "6310": "Debounce keypress",
        "631a": "Delay B frames",
        "6322": "Clear sprite table (all 12 sprites)",
        "632d": "Initialise all objects to start positions",
        "634f": "Screen sync — sound generation, particles, clock wait",
        "63ba": "Full screen redraw — room, objects, sprites, particles",
        "63ea": "Clear entire screen and attributes",
        "6406": "Set ULAplus palette (64 entries)",
        "642b": "Check and remove fodder block",
        "6451": "Colour sprite — write ink attributes around sprite",
        "64c3": "Process all 55 shrapnel/particle slots",
        "64ef": "Explosion shrapnel movement (sine table based)",
        "6567": "Plot/erase shrapnel pixel (XOR)",
        "6585": "Kill shrapnel particle (disable slot)",
        "65d2": "Vapour trail particle movement",
        "65fb": "Laser particle movement",
        "6619": "Fire laser from sprite position",
        "663b": "Create vapour trail at sprite position",
        "666e": "Create starfield particle",
        "66b3": "Find free particle slot in shrapnel table",
        "66c6": "Create explosion at sprite position (fill free slots)",
        "6700": "Quick random number generator",
        "670d": "Display all shrapnel pixels",
        "6724": "Initialise particle engine (clear all slots)",
        "6733": "Laser-sprite collision check",
        "6768": "Main game loop wrapper (calls game repeatedly)",
        "676d": "Game init — screen address table, intro event, first screen",
        "6793": "Full restart — clear all sprites, init from room data",
        "679f": "Partial restart — keep player, clear enemies",
        "67c1": "Per-frame main loop — vsync, sprites, events, collisions",
        "67fc": "Next level — increment screen, restart",
        "680b": "Player death handler — clear dead flag, call death event",
        "681c": "Game end — compare score vs high score, update if better",
        "683e": "Restart event dispatch",
        "6841": "Convert number to ASCII string (leading spaces)",
        "6862": "Convert number to 2-digit ASCII",
        "6869": "Convert number to 3-digit ASCII (leading zeros)",
        "6872": "Initialise score to all zeros",
        "687d": "Multiply H × D → result in HL",
        "6895": "Divide D ÷ E → quotient D, remainder A",
        "68a3": "Show objects present on current screen",
        "68c1": "Display object sprite at its coordinates",
        "68d0": "Display object with colour attributes",
        "691d": "Remove object from game (set room to 254)",
        "6923": "Pick up object (set room to 255 = pockets)",
        "693e": "Check if object is in pockets (zero flag = yes)",
        "6948": "Find object address in table",
        "6955": "Drop object at current (dispx, dispy) position",
        "6969": "Seek objects at sprite position",
        "699c": "Spawn new sprite in first free slot",
        "69ee": "Player score (6 ASCII digits)",
        "69f4": "High score (6 ASCII digits)",
        "69fa": "Bonus score (6 ASCII digits)",
        "6a00": "Graphics base address for character printing",
        "6a08": "Display score at current print position",
        "6a39": "Add value to score (HL points to digits to add)",
        "6a4e": "Add bonus score to main score",
        "6a6b": "Swap score and bonus values",
        "6a7d": "Get print address in DE from (dispx, dispy)",
        "6a94": "Get property buffer address in HL",
        "6aa5": "Get attribute address in HL",
        "6aba": "Print character pixels to screen (8x8)",
        "6ad8": "Print block attributes, properties and pixels",
        "6aeb": "Print attributes without properties",
        "6b07": "Print character and advance cursor position",
        "6b1e": "XOR sprite display (16x16 with pixel shift)",
        "6b33": "Get room data address for given screen number",
        "6b46": "Draw current room from compressed screen data",
        "6b7d": "Decompress screen byte (RLE with marker 255)",
        "6b9f": "Ladder down check",
        "6ba9": "Ladder up check",
        "6bc4": "Can go up — check background blocks above sprite",
        "6bdd": "Can go down — check background blocks below sprite",
        "6bf8": "Can go left — check background blocks to left",
        "6c07": "Can go right — check background blocks to right",
        "6c3c": "Always return zero (xor a; ret)",
        "6c3e": "Platform/wall/fodder check — returns 1 if solid",
        "6c52": "Get collectables at player position",
        "6c75": "Remove collectable block and trigger event",
        "6c89": "Touched deadly/custom block check (all 4 corners)",
        "6ce7": "Get block type at (dispx, dispy) position",
        "6cee": "Initiate jump with gravity table",
        "6d05": "Initiate hop (shorter jump)",
        "6d10": "Pseudo-random number generator (16-bit LFSR)",
        "6d32": "Test specific keyboard key (row/column in B)",
        "6d4a": "Read joystick/keyboard — result in joyval",
        "6d8e": "Kempston joystick reading (port 31)",
        "6da1": "Sinclair joystick reading (port 63486)",
        "6dc6": "Display text message by number",
        "6df1": "Display big (double-height) text message",
        "6e15": "Big (double-height) character display",
        "6e39": "Display character with auto-size (normal or big)",
        "6e47": "Advance to next print column",
        "6e4c": "Advance to next print line",
        "6e69": "Pre-print setup — set font and cursor to window origin",
        "6e7c": "Get word from message list by index",
        "6e88": "Bubble sort sprites by Y coordinate for draw order",
        "6ecb": "Swap two adjacent sprites in table",
        "6ee3": "Process all sprites — copy new→old, call event handlers",
        "6f30": "Original sprite pointer (for event handler context)",
        "6f32": "Event handler address table (9 sprite types × 2 bytes)",
        "6f44": "Display half the sprites (draw/erase/update)",
        "6fab": "Calculate sprite screen address from new position",
        "6fb3": "Calculate sprite screen address from old position",
        "6fcf": "Screen address from (D=y, E=x) coordinates",
        "6fed": "Show single sprite at old position (erase/redraw)",
        "6ffd": "Show single sprite at new position",
        "7002": "Show sprite at both old and new positions (move)",
        "700c": "Calculate next screen line address (HL += 1 line)",
        "701d": "Animate sprite forward (next frame)",
        "7026": "Animate sprite backward (previous frame)",
        "703a": "Find sprite of given type and check collision",
        "7060": "Collision detection entry — check sprite pair",
        "706a": "16×16 bounding box collision check",
        "7084": "Display number as 3-digit text",
        "70a0": "Initialise screen from room table / map data",
        "70a9": "Test/lookup screen in map data",
        "70b4": "Navigate to screen left",
        "70c7": "Navigate to screen right",
        "70cd": "Navigate to screen up",
        "70d4": "Navigate to screen down",
        "70d9": "Jump to specific screen by number",
        "70ee": "Gravity processing — read jump table, move sprite up/down",
        "7130": "Old gravity processing (v4.6/4.7 compatible)",
        "7171": "Initiate fall — find landing point in jump table",
        "7193": "Table-based fall initiation (start from table beginning)",
        "71a6": "Get frame data address for sprite image",
        "71b6": "Find sprite list for current room in enemy data",
        "71c9": "Clear all non-player sprites",
        "71d6": "Initialise sprites from room enemy data",
        "71f6": "Initialise sprites from room data (keep player)",
        "7216": "Copy sprite from enemy list to sprite table",
        "7260": "Clear play area window (pixels + attributes)",
        "729d": "Scrolling ticker text routine",
        "730b": "Initialise scrolling ticker text",
        "733d": "Sprite table (12 sprites × 17 bytes = 204 bytes)",
        "7409": "Spare sprite slot (used during spawn)",
        "741a": "Room table position byte"
    },
    "regions": [
        { "start": 24832, "end": 25160, "type": "code", "comment": "AGD engine entry, variables, data pointers" },
        { "start": 25160, "end": 25539, "type": "code", "comment": "AGD menu/inventory/message box" },
        { "start": 25539, "end": 25902, "type": "code", "comment": "AGD input, sprite table init, objects" },
        { "start": 25902, "end": 26473, "type": "code", "comment": "AGD vsync, sound, screen redraw" },
        { "start": 26473, "end": 27107, "type": "code", "comment": "AGD sprite colouring, particle engine" },
        { "start": 27107, "end": 27496, "type": "code", "comment": "AGD game loop, death, scoring" },
        { "start": 27496, "end": 27901, "type": "code", "comment": "AGD objects, spawn, score display" },
        { "start": 27901, "end": 28193, "type": "code", "comment": "AGD printing, room drawing" },
        { "start": 28193, "end": 28750, "type": "code", "comment": "AGD movement, collision, physics" },
        { "start": 28750, "end": 29443, "type": "code", "comment": "AGD input, messages, sprite processing" },
        { "start": 29443, "end": 29501, "type": "code", "comment": "AGD screen navigation, gravity" },
        { "start": 29501, "end": 29757, "type": "code", "comment": "AGD sprite init, window clear, scrolling" },
        { "start": 29757, "end": 29961, "type": "db", "comment": "AGD sprite table (12×17 + spare)" }
    ],
    "stats": {
        "labels": 192,
        "regions": 13,
        "comments": 130,
        "anchors": 0
    }
}
